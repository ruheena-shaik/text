{"version":3,"file":"js/7367.2839062b.js","mappings":"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","sources":["webpack://aw-webui/./src/visualizations/TimelineInspect.vue","webpack://aw-webui/./src/visualizations/timeline.js","webpack://aw-webui/./src/visualizations/TimelineInspect.vue?fa31","webpack://aw-webui/./src/visualizations/TimelineInspect.vue?7369"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div')\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","'use strict';\n\n/*\n * Creates a colored timeline where you can hover for more info.\n */\n\nconst d3 = require('d3');\nconst Color = require('color');\nconst _ = require('lodash');\nconst moment = require('moment');\n\nimport { getColorFromString } from '../util/color';\n\nimport { seconds_to_duration } from '../util/time';\n\nfunction show_info(container, elem_id) {\n  const title_event_box = container.querySelector('#' + elem_id);\n  const titleinfo = container.querySelector('.titleinfo-container');\n  titleinfo.innerHTML = title_event_box.innerHTML;\n  titleinfo.style.height = title_event_box.getAttribute('height');\n}\n\nfunction create(container) {\n  // Clear element\n  container.innerHTML = '';\n\n  // svg for the colored timeline\n  d3.select(container)\n    .append('svg')\n    .attr('class', 'apptimeline')\n    .attr('viewBox', '0 0 100 10')\n    .attr('width', '100%');\n\n  // Hidden svg image that stores all titleinfo for each timeperiod\n  d3.select(container).append('div').attr('class', 'titleinfo-list').attr('display', 'none');\n\n  // Container for titleinfo that has a fixed size and a overflow scroll\n  const titleinfo_container = document.createElement('div');\n  titleinfo_container.style.width = '100%';\n  titleinfo_container.style.height = '200px';\n  titleinfo_container.style.overflowY = 'scroll';\n  container.appendChild(titleinfo_container);\n\n  // Titleinfo box that changes content depending on what was timeperiod was last recently hovered on\n  d3.select(titleinfo_container)\n    .append('div')\n    .attr('width', '100%')\n    .attr('class', 'titleinfo-container');\n}\n\nfunction set_status(container, text) {\n  const timeline_elem = container.querySelector('.apptimeline');\n  const titleinfo_list_elem = container.querySelector('.titleinfo-list');\n  const titleinfo_container_elem = container.querySelector('.titleinfo-container');\n\n  const timeline = d3.select(timeline_elem);\n  timeline_elem.innerHTML = '';\n  titleinfo_list_elem.innerHTML = '';\n  titleinfo_container_elem.innerHTML = '';\n\n  timeline\n    .append('text')\n    .attr('x', '0')\n    .attr('y', '3')\n    .text(text)\n    .attr('font-family', 'sans-serif')\n    .attr('font-size', '3')\n    .attr('fill', 'black');\n}\n\nfunction update(container, events, showAFK, chunkfunc, eventfunc) {\n  const timeline = d3.select(container.querySelector('.apptimeline')).html(null);\n  const titleinfo_list = d3.select(container.querySelector('.titleinfo-list')).html(null);\n  d3.select(container.querySelector('.titleinfo-container')).html(null);\n\n  if (events.length <= 0) {\n    set_status(container, 'No data');\n    return;\n  }\n\n  const firstEvent = events[0];\n  const lastEvent = events[events.length - 1];\n\n  const timeStart = moment(firstEvent.timestamp);\n  const timeEnd = moment(lastEvent.timestamp).add(lastEvent.duration, 'seconds');\n  const totalDuration = _.sumBy(events, 'duration');\n\n  const secSinceStart = timeEnd.diff(timeStart, 'seconds', true);\n\n  // Iterate over each app timeperiod\n  let curr_x = 0;\n  _.each(events, function (e, i) {\n    // Timeline rect\n\n    let eventX, eventWidth;\n    if (showAFK) {\n      const eventBegin = moment(e.timestamp);\n      eventX = eventBegin.diff(timeStart, 'seconds', true) / secSinceStart;\n      eventX = eventX * 100 + '%';\n      eventWidth = (e.duration / secSinceStart) * 100 + '%';\n    } else {\n      eventX = curr_x;\n      eventWidth = (e.duration / totalDuration) * 100;\n    }\n\n    const appcolor = getColorFromString(chunkfunc(e));\n    const hovercolor = Color(appcolor).darken(0.4).hex();\n\n    const eg = timeline.append('g').attr('id', 'timeline_event_' + i);\n\n    const rect = eg\n      .append('rect')\n      .attr('x', eventX)\n      .attr('y', 0)\n      .attr('width', eventWidth)\n      .attr('height', 10)\n      .style('fill', appcolor)\n      .on('mouseover', () => {\n        rect.style('fill', hovercolor);\n        show_info(container, 'titleinfo_event_' + i);\n      })\n      .on('mouseout', () => {\n        rect.style('fill', appcolor);\n      });\n\n    // Titleinfo box\n    const infobox = titleinfo_list\n      .append('div')\n      .attr('id', 'titleinfo_event_' + i)\n      .style('display', 'none');\n\n    // Appname and duration text\n    infobox\n      .append('h5')\n      .attr('x', '10px')\n      .attr('y', '20px')\n      .text(chunkfunc(e) + ' (' + seconds_to_duration(e.duration) + ')')\n      .attr('font-family', 'sans-serif')\n      .attr('font-size', '20px')\n      .attr('fill', 'black');\n\n    // Titleinfo\n    const infolist = infobox.append('table');\n    _.each(e.data.subevents, function (t) {\n      const inforow = infolist.append('tr');\n      // Clocktime\n      const clocktime = moment(t.timestamp).format('HH:mm:ss');\n      inforow.append('td').text(clocktime);\n      // Duration\n      const duration = seconds_to_duration(t.duration);\n      inforow.append('td').text(duration).style('padding-left', '1em').style('text-align', 'right');\n      // Title\n      inforow.append('td').text(eventfunc(t)).style('padding-left', '1em');\n    });\n\n    curr_x += eventWidth;\n  });\n\n  return container;\n}\n\nexport default {\n  create: create,\n  update: update,\n  set_status: set_status,\n};\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-typescript/node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-38.use[2]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TimelineInspect.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-typescript/node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-38.use[2]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TimelineInspect.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./TimelineInspect.vue?vue&type=template&id=51a0712d&scoped=true&lang=pug\"\nimport script from \"./TimelineInspect.vue?vue&type=script&lang=ts\"\nexport * from \"./TimelineInspect.vue?vue&type=script&lang=ts\"\nimport style0 from \"./TimelineInspect.vue?vue&type=style&index=0&id=51a0712d&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"51a0712d\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticRenderFns","d3","require","Color","_","moment","show_info","container","elem_id","title_event_box","querySelector","titleinfo","innerHTML","style","height","getAttribute","create","select","append","attr","titleinfo_container","document","createElement","width","overflowY","appendChild","set_status","text","timeline_elem","titleinfo_list_elem","titleinfo_container_elem","timeline","update","events","showAFK","chunkfunc","eventfunc","html","titleinfo_list","length","firstEvent","lastEvent","timeStart","timestamp","timeEnd","add","duration","totalDuration","sumBy","secSinceStart","diff","curr_x","each","e","i","eventX","eventWidth","eventBegin","appcolor","getColorFromString","hovercolor","darken","hex","eg","rect","on","infobox","seconds_to_duration","infolist","data","subevents","t","inforow","clocktime","format","name","props","chunks","type","Object","show_afk","Boolean","Function","watch","mounted","$el","methods","component"],"sourceRoot":""}