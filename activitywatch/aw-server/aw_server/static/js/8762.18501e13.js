(self["webpackChunkaw_webui"]=self["webpackChunkaw_webui"]||[]).push([[8762,4792],{86845:(t,e,n)=>{"use strict";n.d(e,{v:()=>w});var r=n(35161),s=n.n(r),i=n(6162),a=n.n(i),l=n(85564),o=n.n(l),c=n(45578),u=n.n(c),h=n(89734),d=n.n(h),f=n(50361),g=n.n(f),p=n(18446),v=n.n(p),m=(n(47042),n(68309),n(69826),n(41539),n(21249),n(57327),n(57658),n(69600),n(2707),n(92222),n(21036)),_=n(3181),b=n(69876);function y(t,e){if(t&&t.data&&t.data.score)return t.data.score;if(t&&t.name.slice(0,-1).length>0){var n=t.name.slice(0,-1),r=e.find((function(t){return v()(t.name,n)}));return y(r,e)}return 0}var w=(0,b.Q_)("categories",{state:function(){return{classes:[],classes_unsaved_changes:!1}},getters:{classes_clean:function(){return this.classes.map(m.C_)},classes_hierarchy:function(){var t=(0,m.wF)(g()(this.classes));return d()(t,[function(t){return t.id||0}])},classes_for_query:function(){return this.classes.filter((function(t){return null!==t.rule.type})).map((function(t){return[t.name,t.rule]}))},all_categories:function(){return u()(o()(this.classes.map((function(t){for(var e=[],n=1;n<=t.name.length;n++)e.push(t.name.slice(0,n));return e}))),(function(t){return t.join(">>>>")}))},allCategoriesSelect:function(){var t=this.all_categories,e=t.map((function(t){return{text:t.join(" > "),value:t,id:t.id}}));return d()(e,"text")},get_category:function(){var t=this;return function(e){("string"===typeof e||e instanceof String)&&console.error("Passed category was string, expected array. Lookup will fail.");var n=t.classes.find((function(t){return v()(t.name,e)}));return n?(0,m.i8)(g()(n)):(v()(e,["Uncategorized"])||console.error("Couldn't find category: ",e),{name:["Uncategorized"],rule:{type:"none"}})}},get_category_by_id:function(){var t=this;return function(e){return(0,m.i8)(g()(t.classes.find((function(t){return t.id==e}))))}},get_category_color:function(){var t=this;return function(e){return(0,_.EB)(t.get_category(e),t.classes)}},get_category_score:function(){var t=this;return function(e){return y(t.get_category(e),t.classes)}},category_select:function(){var t=this;return function(e){var n=t.all_categories;return n=n.map((function(t){return{text:t.join(" > "),value:t}})).sort((function(t,e){return t.text>e.text})),e&&(n=[{text:"All",value:null},{text:"Uncategorized",value:["Uncategorized"]}].concat(n)),n}}},actions:{load:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t&&(t=(0,m.gH)()),t=(0,m.Kj)(t);var e=0;this.classes=t.map((function(t){return Object.assign(t,{id:e++})})),this.classes_unsaved_changes=!1},save:function(){var t=(0,m.yV)(this.classes);return this.classes_unsaved_changes=!1,t},import:function(t){var e=0;this.classes=t.map((function(t){return Object.assign(t,{id:e++})})),this.classes_unsaved_changes=!0},updateClass:function(t){console.log("Updating class:",t);var e=this.classes.find((function(e){return e.id===t.id})),n=e.name,r=e.name.length;void 0===t.id||null===t.id?(t.id=a()(s()(this.classes,"id"))+1,this.classes.push(t)):Object.assign(e,t),s()(this.classes,(function(e){v()(n,e.name.slice(0,r))&&(e.name=t.name.concat(e.name.slice(r)),console.log("Renamed child:",e.name))})),this.classes_unsaved_changes=!0},addClass:function(t){t.id=a()(s()(this.classes,"id"))+1,this.classes.push(t),this.classes_unsaved_changes=!0},removeClass:function(t){this.classes=this.classes.filter((function(e){return e.id!==t})),this.classes_unsaved_changes=!0},appendClassRule:function(t,e){var n=this.classes.find((function(e){return e.id===t}));"none"===n.rule.type||null===n.rule.type?(n.rule.type="regex",n.rule.regex=e):"regex"===n.rule.type&&(n.rule.regex+="|"+e),this.classes_unsaved_changes=!0},restoreDefaultClasses:function(){var t=0;this.classes=(0,m.Kj)(m.D$).map((function(e){return Object.assign(e,{id:t++})})),this.classes_unsaved_changes=!0},clearAll:function(){this.classes=[],this.classes_unsaved_changes=!0}}})},14792:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p});let r={};const s={name:"fa-icon",props:{name:{type:String,validator(t){return!t||t in r||(console.warn(`Invalid prop: prop "name" is referring to an unregistered icon "${t}".\nPlease make sure you have imported this icon before using it.`),!1)}},title:String,scale:[Number,String],spin:Boolean,inverse:Boolean,pulse:Boolean,flip:{validator(t){return"horizontal"===t||"vertical"===t}},label:String,tabindex:[Number,String]},data(){return{id:l(),x:!1,y:!1,childrenWidth:0,childrenHeight:0,outerScale:1}},computed:{normalizedScale(){let t=this.scale;return t="undefined"===typeof t?1:Number(t),isNaN(t)||t<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.',this),this.outerScale):t*this.outerScale},klass(){return{"fa-icon":!0,"fa-spin":this.spin,"fa-flip-horizontal":"horizontal"===this.flip,"fa-flip-vertical":"vertical"===this.flip,"fa-inverse":this.inverse,"fa-pulse":this.pulse,[this.$options.name]:!0}},icon(){return this.name?r[this.name]:null},box(){return this.icon?`0 0 ${this.icon.width} ${this.icon.height}`:`0 0 ${this.width} ${this.height}`},ratio(){if(!this.icon)return 1;let{width:t,height:e}=this.icon;return Math.max(t,e)/16},width(){return this.childrenWidth||this.icon&&this.icon.width/this.ratio*this.normalizedScale||0},height(){return this.childrenHeight||this.icon&&this.icon.height/this.ratio*this.normalizedScale||0},style(){return 1!==this.normalizedScale&&{fontSize:this.normalizedScale+"em"}},raw(){if(!this.icon||!this.icon.raw)return null;let t=this.icon.raw,e={};return t=t.replace(/\s(?:xml:)?id=(["']?)([^"')\s]+)\1/g,((t,n,r)=>{let s=l();return e[r]=s,` id="${s}"`})),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,((t,n,r,s)=>{let i=n||s;return i&&e[i]?`#${e[i]}`:t})),t},focusable(){let{tabindex:t}=this;if(null==t)return"false";let e="string"===typeof t?parseInt(t,10):t;return e>=0?null:"false"}},mounted(){this.updateStack()},updated(){this.updateStack()},methods:{updateStack(){if(!this.name&&null!==this.name&&0===this.$children.length)return void console.warn('Invalid prop: prop "name" is required.');if(this.icon)return;let t=0,e=0;this.$children.forEach((n=>{n.outerScale=this.normalizedScale,t=Math.max(t,n.width),e=Math.max(e,n.height)})),this.childrenWidth=t,this.childrenHeight=e,this.$children.forEach((n=>{n.x=(t-n.width)/2,n.y=(e-n.height)/2}))}},render(t){if(null===this.name)return t();let e={class:this.klass,style:this.style,attrs:{role:this.$attrs.role||(this.label||this.title?"img":null),"aria-label":this.label||null,"aria-hidden":String(!(this.label||this.title)),tabindex:this.tabindex,x:this.x,y:this.y,width:this.width,height:this.height,viewBox:this.box,focusable:this.focusable}},n=`vat-${this.id}`;if(this.title&&(e.attrs["aria-labelledby"]=n),this.raw){let t=this.raw;this.title&&(t=`<title id="${n}">${c(this.title)}</title>${t}`),e.domProps={innerHTML:t}}let r=this.title?[t("title",{attrs:{id:n}},this.title)]:[];return t("svg",e,this.raw?null:r.concat(this.$slots.default||[...this.icon.paths.map(((e,n)=>t("path",{attrs:e,key:`path-${n}`}))),...this.icon.polygons.map(((e,n)=>t("polygon",{attrs:e,key:`polygon-${n}`})))]))},register(t){for(let e in t){let n=t[e],{paths:s=[],d:a,polygons:l=[],points:o}=n;a&&s.push({d:a}),o&&l.push({points:o}),r[e]=i({},n,{paths:s,polygons:l})}},icons:r};function i(t,...e){return e.forEach((e=>{for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})),t}let a=870711;function l(){return`va-${(a++).toString(16)}`}const o={"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"};function c(t){return t.replace(/[<>"&]/g,(t=>o[t]||t))}const u=s;var h,d,f=n(1001),g=(0,f.Z)(u,h,d,!1,null,null,null);const p=g.exports},78762:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>S});n(68309),n(69600);var r=function(){var t=this,e=t._self._c;return e("div",[e("h3",[t._v("Alerts")]),e("b-alert",{staticStyle:{},attrs:{show:""}},[t._v("This feature is still in early development.")]),t.error?e("b-alert",{attrs:{show:"",variant:"danger"}},[t._v(t._s(t.error))]):t._e(),t._l(t.alerts,(function(n){return e("b-card",{key:n.name},[e("b-button",{staticClass:"float-right",attrs:{size:"sm",variant:"outline-danger"},on:{click:function(e){return t.deleteAlert(n.name)}}},[e("icon",{attrs:{name:"trash"}})],1),e("div",[t._v("Goal name: "+t._s(n.name))]),e("div",[t._v("Category: "+t._s(n.category.join(" > ")))]),e("div",[t._v("Current: "+t._s(t._f("friendlyduration")(t.alertTime(n.category)))+" / "+t._s(n.goal)+" minutes"),t.alertTime(n.category)>=n.goal?e("span",[e("icon",{staticStyle:{color:"#0C0"},attrs:{name:"check"}})],1):e("span",[e("icon",{attrs:{name:"times",color:"#555"}})],1)])],1)})),e("b-input-group",{staticClass:"mt-3"},[e("b-btn",{attrs:{variant:"success"},on:{click:t.check}},[t._v("Check")]),e("b-input-group-append",[e("b-form-checkbox",{staticClass:"my-2 ml-3",attrs:{switch:""},on:{change:t.toggleAutoRefresh},model:{value:t.autorefresh,callback:function(e){t.autorefresh=e},expression:"autorefresh"}},[t._v("Toggle autorefresh every 10s")])],1)],1),t.last_updated?e("small",[t._v("Last updated: "+t._s(t.last_updated))]):t._e(),e("hr"),e("div",[e("h4",[t._v("New alert")]),e("b-form-group",{attrs:{label:"Name","label-cols-md":"2"}},[e("b-input",{model:{value:t.editing_alert.name,callback:function(e){t.$set(t.editing_alert,"name",e)},expression:"editing_alert.name"}})],1),e("b-form-group",{attrs:{label:"Category","label-cols-md":"2"}},[e("b-select",{model:{value:t.editing_alert.category,callback:function(e){t.$set(t.editing_alert,"category",e)},expression:"editing_alert.category"}},t._l(t.categories,(function(n){return e("option",{domProps:{value:n.value}},[t._v(t._s(n.text))])})),0)],1),e("b-form-group",{attrs:{label:"Goal","label-cols-md":"2"}},[e("b-input-group",{attrs:{append:"minutes"}},[e("b-input",{attrs:{type:"number"},model:{value:t.editing_alert.goal,callback:function(e){t.$set(t.editing_alert,"goal",e)},expression:"editing_alert.goal"}})],1)],1),e("div",[e("b-btn",{attrs:{variant:"success"},on:{click:t.addAlert}},[e("icon",{attrs:{name:"plus"}}),t._v("Add alert")],1)],1)],1)],2)},s=[],i=n(97911),a=n(51055),l=n(27981),o=n(19837),c=n(73303),u=n.n(c),h=n(7739),d=n.n(h),f=n(35161),g=n.n(f),p=(n(69720),n(23157),n(92222),n(57327),n(41539),n(32564),n(21249),n(73210),n(38559),n(83710),n(30381)),v=n.n(p),m=n(72260),_=(n(46125),n(46308),n(14169),n(96886),n(85711)),b=n(86845);const y={name:"Alerts",data:function(){return{bucketsStore:(0,_.U)(),categoryStore:(0,b.v)(),alerts:[{name:"Work",category:["Work"],goal:100},{name:"Media",category:["Media"],goal:10}],editing_alert:{},alert_times:{},error:"",hostnames:[],hostname:"",last_updated:null,autorefresh:!1,running_interval:null,show_options:!1,use_regex:!0,filter_afk:!0}},computed:{categories:function(){return this.categoryStore.category_select(!0)},alertTime:function(){var t=this;return function(e){var n=0;return g()(Object.entries(t.alert_times),(function(t){var r=(0,o.Z)(t,2),s=r[0],i=r[1];s.startsWith(e.join(","))&&"number"===typeof i&&(n+=i)})),n}}},mounted:function(){var t=(0,l.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.bucketsStore.ensureLoaded();case 2:return t.next=4,this.categoryStore.load();case 4:this.hostnames=this.bucketsStore.hosts,this.hostname=this.hostnames[0];case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{addAlert:function(){this.alerts=this.alerts.concat((0,i.Z)({},this.editing_alert))},deleteAlert:function(t){this.alerts=this.alerts.filter((function(e){return e.name!==t}))},toggleAutoRefresh:function(){!this.autorefresh||this.running_interval?(console.log("Stopping autorefresh"),clearInterval(this.running_interval),this.autorefresh=!1,this.running_interval=null):(console.log("Starting autorefresh"),this.autorefresh=!0,this.running_interval=setInterval(this.check,1e4))},check:function(){var t=(0,l.Z)((0,a.Z)().mark((function t(){var e,n,r,s,i,l,c,h;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=(0,m.l8)({bid_window:"aw-watcher-window_"+this.hostname,bid_afk:"aw-watcher-afk_"+this.hostname,filter_afk:this.filter_afk,categories:(0,b.v)().classes_for_query,filter_categories:null}),e+="; RETURN = events;",n=e.split(";").map((function(t){return t.trim()+";"})),r=v()().subtract(1,"days").startOf("day"),s=v()(r).add(1,"days"),i=[r.format()+"/"+s.format()],t.prev=6,this.status="searching",t.next=10,this.$aw.query(i,n);case 10:l=t.sent,this.events=l[0],this.error="",t.next=20;break;case 15:return t.prev=15,t.t0=t["catch"](6),console.error(t.t0),this.error=t.t0.response.data.message,t.abrupt("return");case 20:return t.prev=20,this.status=null,t.finish(20);case 23:c=d()(this.events,(function(t){return t.data.$category})),h=Object.fromEntries(g()(Object.entries(c),(function(t){var e=(0,o.Z)(t,2),n=e[0],r=e[1];return[n.split(","),u()(r,"duration")]}))),this.alert_times=h,this.last_updated=new Date;case 27:case"end":return t.stop()}}),t,this,[[6,15,20,23]])})));function e(){return t.apply(this,arguments)}return e}()}},w=y;var x=n(1001),k=(0,x.Z)(w,r,s,!1,null,"192122a7",null);const S=k.exports},5976:(t,e,n)=>{var r=n(6557),s=n(45357),i=n(30061);function a(t,e){return i(s(t,e,r),t+"")}t.exports=a},67762:t=>{function e(t,e){var n,r=-1,s=t.length;while(++r<s){var i=e(t[r]);void 0!==i&&(n=void 0===n?i:n+i)}return n}t.exports=e},16612:(t,e,n)=>{var r=n(77813),s=n(98612),i=n(65776),a=n(13218);function l(t,e,n){if(!a(n))return!1;var l=typeof e;return!!("number"==l?s(n)&&i(e,n.length):"string"==l&&e in n)&&r(n[e],t)}t.exports=l},89734:(t,e,n)=>{var r=n(21078),s=n(82689),i=n(5976),a=n(16612),l=i((function(t,e){if(null==t)return[];var n=e.length;return n>1&&a(t,e[0],e[1])?e=[]:n>2&&a(e[0],e[1],e[2])&&(e=[e[0]]),s(t,r(e,1),[])}));t.exports=l},73303:(t,e,n)=>{var r=n(67206),s=n(67762);function i(t,e){return t&&t.length?s(t,r(e,2)):0}t.exports=i},45578:(t,e,n)=>{var r=n(67206),s=n(45652);function i(t,e){return t&&t.length?s(t,r(e,2)):[]}t.exports=i},46308:(t,e,n)=>{"use strict";var r=n(14792);r["default"].register({check:{width:512,height:512,paths:[{d:"M173.9 439.4l-166.4-166.4c-10-10-10-26.2 0-36.2l36.2-36.2c10-10 26.2-10 36.2 0l112.1 112.1 240.1-240.1c10-10 26.2-10 36.2 0l36.2 36.2c10 10 10 26.2 0 36.2l-294.4 294.4c-10 10-26.2 10-36.2 0z"}]}})},46125:(t,e,n)=>{"use strict";var r=n(14792);r["default"].register({plus:{width:448,height:512,paths:[{d:"M416 208c17.7 0 32 14.3 32 32v32c0 17.7-14.3 32-32 32h-144v144c0 17.7-14.3 32-32 32h-32c-17.7 0-32-14.3-32-32v-144h-144c-17.7 0-32-14.3-32-32v-32c0-17.7 14.3-32 32-32h144v-144c0-17.7 14.3-32 32-32h32c17.7 0 32 14.3 32 32v144h144z"}]}})},14169:(t,e,n)=>{"use strict";var r=n(14792);r["default"].register({times:{width:352,height:512,paths:[{d:"M242.7 256l100.1 100.1c12.3 12.3 12.3 32.2 0 44.5l-22.2 22.2c-12.3 12.3-32.2 12.3-44.5 0l-100.1-100.1-100.1 100.1c-12.3 12.3-32.2 12.3-44.5 0l-22.2-22.2c-12.3-12.3-12.3-32.2 0-44.5l100.1-100.1-100.1-100.1c-12.3-12.3-12.3-32.2 0-44.5l22.2-22.2c12.3-12.3 32.2-12.3 44.5 0l100.1 100.1 100.1-100.1c12.3-12.3 32.2-12.3 44.5 0l22.2 22.2c12.3 12.3 12.3 32.2 0 44.5z"}]}})},96886:(t,e,n)=>{"use strict";var r=n(14792);r["default"].register({trash:{width:448,height:512,paths:[{d:"M432 32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-416c-8.8 0-16-7.2-16-16v-32c0-8.8 7.2-16 16-16h120l9.4-18.7c3.6-7.3 13.1-13.3 21.3-13.3h0.1 114.3 0c8.2 0 17.8 6 21.5 13.3l9.4 18.7h120zM53.2 467l-21.2-339h384l-21.2 339c-1.6 24.8-23 45-47.9 45h-245.8c-24.9 0-46.3-20.2-47.9-45z"}]}})}}]);
//# sourceMappingURL=8762.18501e13.js.map